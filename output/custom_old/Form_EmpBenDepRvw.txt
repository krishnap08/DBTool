<!-- Form: EmpBenDepRvw -->
<!-- Scripts Inclusion Block Starts -->
<script name="EmpDepCombo" />
<script name="BenCombo" />
<!-- Scripts Inclusion Block Ends -->
<!-- Event Handlling Block Starts -->
<!-- Client Side Event Handling Block Starts -->
<event name="onLoad" where="Client">
  <native lang="Javascript">
    <![CDATA[
            var v_iCnt;
            v_iCnt = ctlGetVal("F_RowCnt_main");
            var obj_N_AnnElectAmt;
            var obj_O_AnnElectAmt;
            for (v_i = 1; v_i <= v_iCnt; v_i++) {
              obj_N_AnnElectAmt = ctlGetDef("N_AnnElectAmt_main_" + v_i);
              obj_O_AnnElectAmt = ctlGetDef("O_AnnElectAmt_main_" + v_i);
              if (obj_N_AnnElectAmt && (obj_N_AnnElectAmt.value == "0.00" || obj_N_AnnElectAmt.value == "")) {
                if (!obj_O_AnnElectAmt || obj_O_AnnElectAmt.value == "") {
                  obj_N_AnnElectAmt.value = "0.00";
                } else {
                  obj_N_AnnElectAmt.value = "";
                }
              }
            }
    ]]>
  </native>
</event>
<event name="BeforeSave" where="Client">
  <native lang="Javascript">
    <![CDATA[
            v_Return = checkBnfPct("Bnf");
            if (v_Return) {
              v_Return = checkBnfPct("PendBenBnf");
            }
            return v_Return;
    ]]>
  </native>
</event>
<event name="BeforeNext" where="Client">
  <native lang="Javascript">
    <![CDATA[
            v_Return = checkBnfPct("Bnf");
            if (v_Return) {
              v_Return = checkBnfPct("PendBenBnf");
            }
            return v_Return;
    ]]>
  </native>
</event>
<event name="BeforePrev" where="Client">
  <native lang="Javascript">
    <![CDATA[
            v_Return = checkBnfPct("Bnf");
            if (v_Return) {
              v_Return = checkBnfPct("PendBenBnf");
            }
            return v_Return;
    ]]>
  </native>
</event>
<event name="global" where="Client">
  <native lang="Javascript">
    <![CDATA[
            function checkBnfPct(prm_sDataset) {
              var v_iCnt = 0;
              var v_i = 0;
              var rCtl = "";
              var rCtlVal = "";
              var fPTot = 0.00;
              var fCTot = 0.00;
              var fBPct = 0.00;
              var iCCnt = 0;
              var iPCnt = 0;
              var sBen = "";
              var v_sDataset;
              var sPrevBen = "";
              var sMg = ""; 
              var v_Return = false;
              var v_isDone = false;
              v_sDataset = prm_sDataset;
              v_iCnt = ctlGetVal("F_RowCnt_" + v_sDataset);
              if (v_iCnt > 0) {
                sPrevBen = ctlGetVal("N_Ben_" + v_sDataset + "_1");
                v_i = 1;
                while(!v_isDone) {
                  if (v_i <= v_iCnt) {
                    sBen = ctlGetVal("N_Ben_" + v_sDataset + "_" + v_i);
                  } else {
                    v_isDone = true;
                  }
                  if (sBen != sPrevBen) {
                    if ((iPCnt > 0) && (fPTot.toFixed(2) != 100)) {
                      sMg = "Total Percentage of all the Primary Beneficiaries is not 100%";
                    } else if (iCCnt > 0 && iPCnt <= 0) {
                      sMg = "Contingency Beneficiaries cannot be selected without Primary Beneficiaries";
                    } else if ((iCCnt > 0) && (fCTot.toFixed(2) != 100)) {
                      sMg ="Contingency Beneficiary Percent must total 100%";
                    }
                    if (sMg != "") {
                      v_isDone = true;
                    } else {
                      fPTot = 0.0;
                      fCTot = 0.0;
                      iCCnt = 0;
                      iPCnt = 0;
                    }
                  }
                  if (!v_isDone) {
                    rCtlVal = ctlGetVal("N_SysBnfSelect_" + v_sDataset + "_"+ v_i);
                    if (rCtlVal=="Yes") {
                      rCtlVal = ctlGetVal("N_Contingency_" + v_sDataset + "_"+ v_i);
                      fBPct = parseFloat(ctlGetVal("N_BnfPct_" + v_sDataset + "_"+ v_i));
                      if (rCtlVal == "Yes") {
                        fCTot = parseFloat(fCTot)+parseFloat(fBPct);
                        iCCnt = iCCnt + 1; 
                      } else {
                        fPTot = parseFloat(fPTot )+parseFloat(fBPct);
                        iPCnt = iPCnt + 1; 
                      }
                    }
                    v_i += 1;
                    sPrevBen = sBen;
                    sBen = "";
                  }
                }
                if (sMg != "") {
                  /*
                   * 41543-LM-NV: Fix For Error Message Appears OnClick Of MsgOk
                     # The no. of times the while loop executes is (Dataset_RownCnt + 1).
                     # When the msg function (XHtmlMessages.js) was trying to get the control with index (Dataset_RownCnt + 1) it was throing an error.
                   * v_iCnt, which is Dataset_RownCnt, used instead of v_i.
                   */
                  msg("Beneficiary Percentage Error","msgtext="+sMg,"N_BnfPct_" + v_sDataset + "_" + v_iCnt);
                  v_Return = false;
                } else {
                  v_Return = true;
                }
              } else {
                v_Return = true;
              }
              return v_Return;
            }
    ]]>
  </native>
</event>
<!-- Client Side Event Handling Block Ends -->
<!-- Server Side Event Handling Block Starts -->
<event name="AfterSave" where="Server">
  <foreach dataset="Dep" type="controls">
    <set var="[Emp]">[N_Emp_Dep_[controlrow]]</set>
    <if>
      <when>
        <or>
          <and>
            <eq>
              <val>[N_SysDepSelect_Dep_[controlrow]]</val>
              <val>Yes</val>
            </eq>
            <eq>
              <val>[O_SysDepSelect_Dep_[controlrow]]</val>
              <val>No</val>
            </eq>
          </and>
          <ne>
            <val>[N_DepPhysician_Dep_[controlrow]]</val>
            <val>[O_DepPhysician_Dep_[controlrow]]</val>
          </ne>
        </or>
      </when>
      <then>
        <update dataset="DepUpdate">
          <data>
            <row>
              <fld name="Emp">[N_Emp_Dep_[controlrow]]</fld>
              <fld name="Eml">[N_Eml_Dep_[controlrow]]</fld>
              <fld name="Ben">[N_Ben_Dep_[controlrow]]</fld>
              <fld name="Dep">[N_Dep_Dep_[controlrow]]</fld>
              <fld name="DepPhysician">[N_DepPhysician_Dep_[controlrow]]</fld>
              <fld name="DepBenEligibleDt">[N_EligibleDt_Dep_[controlrow]]</fld>
              <fld name="EmpBenDepEffDt">[N_EmpBenDepEffDt_Dep_[controlrow]]</fld>
              <fld name="EmpBenDepEfdDt">[N_EmpBenDepEfdDt_Dep_[controlrow]]</fld>
              <fld name="DepBenStartDt">[N_EmpBenDepEffDt_Dep_[controlrow]]</fld>
              <fld name="DepBenEndDt">[N_EmpBenDepEfdDt_Dep_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
      <when>
        <and>
          <eq>
            <val>[N_SysDepSelect_Dep_[controlrow]]</val>
            <val>No</val>
          </eq>
          <eq>
            <val>[O_SysDepSelect_Dep_[controlrow]]</val>
            <val>Yes</val>
          </eq>
        </and>
      </when>
      <then>
        <dataset name="EndEmpBenDep">
          <sql>exec ZZEndEmpBenDep '[N_Emp_Dep_[controlrow]]', '[N_Eml_Dep_[controlrow]]', [N_Dep_Dep_[controlrow]], '[N_Ben_Dep_[controlrow]]'</sql>
        </dataset>
        <datasetopen dataset="EndEmpBenDep" />
        <datasetclose dataset="EndEmpBenDep" />
        <commit />
<!-- <delete dataset="DepUpdate">
                <data>
                  <row>
                    <fld name="EmpBenDepId">[N_SysElgDepId_Dep_[controlrow]]</fld>
                  </row>
                </data>
              </delete> -->
      </then>
<!-- <when>
              <and>
                <eq>
                  <val>[N_SysDepSelect_Dep_[controlrow]]</val>
                  <val>Yes</val>
                </eq>
                <gt>
                  <val>[N_SysElgDepId_Dep_[controlrow]]</val>
                  <val>0</val>
                </gt>
              </and>
            </when>
            <then>
              <update dataset="DepUpdate">
                <data>
                  <row>
                    <fld name="EmpBenDepId">[N_SysElgDepId_Dep_[controlrow]]</fld>
                    <fld name="EmpBenDepEffDt">[N_EmpBenEffDt_Dep_[controlrow]]</fld>
                    <fld name="DepPhysician">[N_DepPhysician_Dep_[controlrow]]</fld>
                    <fld name="DepBenEligibleDt">[N_EligibleDt_Dep_[controlrow]]</fld>
                    <fld name="DepBenStartDt">[N_DepBenStartDt_Dep_[controlrow]]</fld>
                  </row>
                </data>
              </update>
            </then> -->
    </if>
  </foreach>
  <foreach dataset="Bnf" type="controls">
    <set var="[EmpBnf]">[N_Emp_Bnf_[controlrow]]</set>
    <if>
      <when>
        <and>
          <eq>
            <val>[N_SysBnfSelect_Bnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <eq>
            <val>[O_SysBnfSelect_Bnf_[controlrow]]</val>
            <val>No</val>
          </eq>
        </and>
      </when>
      <then>
        <update dataset="BnfUpdate">
          <data>
            <row>
              <fld name="Emp">[N_Emp_Bnf_[controlrow]]</fld>
              <fld name="Eml">[N_Eml_Bnf_[controlrow]]</fld>
              <fld name="Ben">[N_Ben_Bnf_[controlrow]]</fld>
              <fld name="BnfNum">[N_BnfNum_Bnf_[controlrow]]</fld>
              <fld name="EmpBenBnfEffDt">[DateTime]</fld>
              <fld name="BnfPct">[N_BnfPct_Bnf_[controlrow]]</fld>
              <fld name="Contingency">[N_Contingency_Bnf_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
      <when>
        <and>
          <ne>
            <val>[N_SysBnfSelect_Bnf_[controlrow]]</val>
            <val>Yes</val>
          </ne>
          <eq>
            <val>[O_SysBnfSelect_Bnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
        </and>
      </when>
      <then>
        <dataset name="EndEmpBenBnf">
          <sql>
                  EXEC ZZEndEmpBenBnf '[N_Emp_Bnf_[controlrow]]', '[N_Eml_Bnf_[controlrow]]', [N_BnfNum_Bnf_[controlrow]], '[N_Ben_Bnf_[controlrow]]'
                </sql>
        </dataset>
        <datasetopen dataset="EndEmpBenBnf" />
        <datasetclose dataset="EndEmpBenBnf" />
        <commit />
<!-- <delete dataset="BnfUpdate">
                <data>
                  <row>
                    <fld name="EmpBenBnfId">[N_SysElgBnfId_Bnf_[controlrow]]</fld>
                  </row>
                </data>
              </delete> -->
      </then>
      <when>
        <and>
          <eq>
            <val>[N_SysBnfSelect_Bnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <gt>
            <val>[N_SysElgBnfId_Bnf_[controlrow]]</val>
            <val>0</val>
          </gt>
        </and>
      </when>
      <then>
        <update dataset="BnfUpdate">
          <data>
            <row>
              <fld name="EmpBenBnfId">[N_SysElgBnfId_Bnf_[controlrow]]</fld>
<!-- <fld name="EmpBenBnfEffDt">[N_EmpBenEffDt_Bnf_[controlrow]]</fld> -->
              <fld name="BnfPct">[N_BnfPct_Bnf_[controlrow]]</fld>
              <fld name="Contingency">[N_Contingency_Bnf_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
    </if>
  </foreach>
  <todo wrkflw="EmpBenDepSync">
    <prm name="N_Emp">[Emp]</prm>
    <prm name="Schedule">No</prm>
  </todo>
<!-- 71348-SK-NV - Logic commented -->
<!-- <todo wrkflw="EmpBenBnfSync">
          <prm name="N_Emp">[EmpBnf]</prm>
          <prm name="Schedule">No</prm>
        </todo> -->
<!-- 36177-LM-NV save dependents for Pending Benefits -->
  <foreach dataset="PendBenDep" type="controls">
    <if>
      <when>
        <and>
          <eq>
            <val>[N_SysDepSelect_PendBenDep_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <eq>
            <val>[O_SysDepSelect_PendBenDep_[controlrow]]</val>
            <val>No</val>
          </eq>
        </and>
      </when>
      <then>
        <update dataset="PendBenDepUpdate">
          <data>
            <row>
              <fld name="Emp">[N_Emp_PendBenDep_[controlrow]]</fld>
              <fld name="Eml">[N_Eml_PendBenDep_[controlrow]]</fld>
              <fld name="Ben">[N_Ben_PendBenDep_[controlrow]]</fld>
              <fld name="Dep">[N_Dep_PendBenDep_[controlrow]]</fld>
              <fld name="EmpBenElgDepEffDt">[DateTime]</fld>
              <fld name="DepPhysician">[N_DepPhysician_PendBenDep_[controlrow]]</fld>
              <fld name="DepBenEligibleDt">[N_EligibleDt_PendBenDep_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
      <when>
        <and>
          <ne>
            <val>[N_SysDepSelect_PendBenDep_[controlrow]]</val>
            <val>Yes</val>
          </ne>
          <eq>
            <val>[O_SysDepSelect_PendBenDep_[controlrow]]</val>
            <val>Yes</val>
          </eq>
        </and>
      </when>
      <then>
        <delete dataset="PendBenDepUpdate">
          <data>
            <row>
              <fld name="EmpBenElgDepId">[N_SysElgDepId_PendBenDep_[controlrow]]</fld>
            </row>
          </data>
        </delete>
      </then>
      <when>
        <and>
          <eq>
            <val>[N_SysDepSelect_PendBenDep_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <gt>
            <val>[N_SysElgDepId_PendBenDep_[controlrow]]</val>
            <val>0</val>
          </gt>
        </and>
      </when>
      <then>
        <update dataset="PendBenDepUpdate">
          <data>
            <row>
              <fld name="EmpBenElgDepId">[N_SysElgDepId_PendBenDep_[controlrow]]</fld>
              <fld name="EmpBenElgDepEffDt">[N_EmpBenElgEffDt_PendBenDep_[controlrow]]</fld>
              <fld name="DepPhysician">[N_DepPhysician_PendBenDep_[controlrow]]</fld>
              <fld name="DepBenEligibleDt">[N_EligibleDt_PendBenDep_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
    </if>
  </foreach>
<!-- 36177-LM-NV update Beneficiaries for Pending Benefits -->
  <foreach dataset="PendBenBnf" type="controls">
    <if>
      <when>
        <and>
          <eq>
            <val>[N_SysBnfSelect_PendBenBnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <eq>
            <val>[O_SysBnfSelect_PendBenBnf_[controlrow]]</val>
            <val>No</val>
          </eq>
        </and>
      </when>
      <then>
        <update dataset="PendBenBnfUpdate">
          <data>
            <row>
              <fld name="Emp">[N_Emp_PendBenBnf_[controlrow]]</fld>
              <fld name="Eml">[N_Eml_PendBenBnf_[controlrow]]</fld>
              <fld name="Ben">[N_Ben_PendBenBnf_[controlrow]]</fld>
              <fld name="BnfNum">[N_BnfNum_PendBenBnf_[controlrow]]</fld>
              <fld name="EmpBenElgBnfEffDt">[DateTime]</fld>
              <fld name="BnfPct">[N_BnfPct_PendBenBnf_[controlrow]]</fld>
              <fld name="Contingency">[N_Contingency_PendBenBnf_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
      <when>
        <and>
          <ne>
            <val>[N_SysBnfSelect_PendBenBnf_[controlrow]]</val>
            <val>Yes</val>
          </ne>
          <eq>
            <val>[O_SysBnfSelect_PendBenBnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
        </and>
      </when>
      <then>
        <delete dataset="PendBenBnfUpdate">
          <data>
            <row>
              <fld name="EmpBenElgBnfId">[N_SysElgBnfId_PendBenBnf_[controlrow]]</fld>
            </row>
          </data>
        </delete>
      </then>
      <when>
        <and>
          <eq>
            <val>[N_SysBnfSelect_PendBenBnf_[controlrow]]</val>
            <val>Yes</val>
          </eq>
          <gt>
            <val>[N_SysElgBnfId_PendBenBnf_[controlrow]]</val>
            <val>0</val>
          </gt>
        </and>
      </when>
      <then>
        <update dataset="PendBenBnfUpdate">
          <data>
            <row>
              <fld name="EmpBenElgBnfId">[N_SysElgBnfId_PendBenBnf_[controlrow]]</fld>
              <fld name="EmpBenElgBnfEffDt">[N_EmpBenElgEffDt_PendBenBnf_[controlrow]]</fld>
              <fld name="BnfPct">[N_BnfPct_PendBenBnf_[controlrow]]</fld>
              <fld name="Contingency">[N_Contingency_PendBenBnf_[controlrow]]</fld>
            </row>
          </data>
        </update>
      </then>
    </if>
  </foreach>
<!-- 36177-LM-NV update and process Pending benefits -->
  <set var="[ProcessBen]">No</set>
  <foreach dataset="PendBen" type="controls">
    <if>
      <when>
        <eq>
          <val>[N_PendBen_PendBen_[controlrow]]</val>
          <val>No</val>
        </eq>
      </when>
      <then>
        <set var="[ProcessBen]">Yes</set>
        <set var="[Emp]">[N_Emp_PendBen_[controlrow]]</set>
      </then>
    </if>
    <update dataset="PendBenUpdate">
      <data>
        <row>
          <fld name="EmpBenElgId">[F_Id_PendBen_[controlrow]]</fld>
          <fld name="PendBen">[N_PendBen_PendBen_[controlrow]]</fld>
          <fld name="Units">[N_Units_PendBen_[controlrow]]</fld>
        </row>
      </data>
    </update>
  </foreach>
  <if>
    <when>
      <eq>
        <val>[ProcessBen]</val>
        <val>Yes</val>
      </eq>
    </when>
    <then>
      <todo wrkflw="BenEnrProcess2">
        <prm name="N_Emp">[Emp]</prm>
        <prm name="Schedule">No</prm>
      </todo>
    </then>
  </if>
</event>
<!-- Server Side Event Handling Block Ends -->
<!-- Event Handling Block Ends -->
<!-- Dataset Definition Block Starts -->
<!--
      # 47409-LM-NV: Main Dataset Modified To Handle Multiple Eml
      # Eml table added into the dataset to group the records by Eml
      # Condition EmpBen.Emp = Eml.Eml added for multiple Eml
      # Join with PayGrp and Job table added to display in the header
      # Field added to sort the records by Eml.Eml
    -->
<dataset name="main">
  <tables>
    <tbl name="Emp" />
<!-- 47409-LM-NV: Join with Eml table added to goup the records by Eml -->
    <tbl name="Eml" join="LEFT" to="Emp">
      <and>
        <eq>
          <fld name="Emp.Emp" />
          <fld name="Eml.Emp" />
        </eq>
        <isnull>
          <fld name="Eml.EmlEfdDt" />
        </isnull>
      </and>
    </tbl>
    <tbl name="EmpBen" main="Yes" join="LEFT">
      <and>
        <eq>
          <fld name="Eml.Emp" />
          <fld name="EmpBen.Emp" />
        </eq>
        <eq>
          <fld name="Eml.Eml" />
          <fld name="EmpBen.Eml" />
        </eq>
      </and>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBen.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="BenPln.PlanType" />
        <fld name="PlnTyp.PlnTyp" />
      </eq>
    </tbl>
<!-- 47409-LM-NV: Join with PayGrp and Job table added to display in the header -->
    <tbl name="Job" join="LEFT" to="Eml">
      <and>
        <eq>
          <fld name="Eml.Job" />
          <fld name="Job.Job" />
        </eq>
        <isnull>
          <fld name="Job.JobEfdDt" />
        </isnull>
      </and>
    </tbl>
    <tbl name="PayGrp" join="LEFT" to="Eml">
      <and>
        <eq>
          <fld name="Eml.PayGrp" />
          <fld name="PayGrp.PayGrp" />
        </eq>
        <isnull>
          <fld name="PayGrp.PayGrpEfdDt" />
        </isnull>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="EmpBen.*" />
    <fld name="EmpBen.Eml" />
    <fld name="EnrSum.EnrSum" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00'+Convert(varchar(15),PlnTyp.PlnOrd),3)
        ]]>
      </native>
    </fld>
    <fld name="PlnTyp.PlnTypName" />
    <fld name="PlnTyp.PlnTypDesc" />
    <fld name="Ben.BenName" />
    <fld name="Ben.IsEmpPremEmpAmt" />
    <fld name="Ben.IsEmpCovEmpAmt" />
    <fld name="Ben.IsCmpPremEmpAmt" />
    <fld name="Ben.IsCmpCovEmpAmt" />
    <fld name="Ben.IsTotPremEmpAmt" />
    <fld name="Ben.IsTotCovEmpAmt" />
    <fld name="Ben.IsFlxCrdEmpAmt" />
    <fld name="EnrSum.EnrStartDt" />
    <fld name="EnrSum.EnrEndDt" />
    <fld name="Ben.BenDesc" />
    <fld name="BenPln.DescLnk" />
    <fld name="BenPln.InsCar" />
    <fld name="BenPln.FSAAllow" />
    <fld name="BenPln.FSADepAllow" />
    <fld name="BenPln.DepAllow" />
    <fld name="BenPln.BenAllow" />
    <fld name="BenPln.ClmAllow" />
    <fld name="BenPln.UntAllow" />
    <fld name="BenPln.PCPAllow" />
    <fld name="EmpName">
      <append>
        <fld name="Emp.LastName" type="String" />
        <val>, </val>
        <fld name="Emp.FirstName" type="String" />
      </append>
    </fld>
    <script name="EmpHeaderFlds" />
<!-- 47409-LM-NV: Fields from Eml table added -->
    <script name="EmlHeaderFlds" />
  </display>
    <where>
    <and>
        <or>
          <and>
            <le>
              <fld name="EnrSum.EnrStartDt" type="datetime"/>
              <val>[Date]</val>
            </le>
            <ge>
              <fld name="EnrSum.EnrEndDt" type="datetime"/>
              <val>[Date]</val>
            </ge>
          </and>
          <isnull>
            <fld name="EnrSum.EnrSumId" />
          </isnull>
        </or>
        <or>
          <isnull>
            <fld name="EmpBen.EmpBenEfdDt" />
          </isnull>
          <ge>
            <fld name="EmpBen.EmpBenEfdDt" type="datetime" />
            <val>[Date]</val>
          </ge>
        </or>
    </and>
    </where>
  <order>
    <fld name="EmpBen.Emp" />
    <fld name="Ben.EnrSum" />
<!-- 47409-LM-NV: Added to sort the records based on Eml -->
    <fld name="EmlVal" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBen.Ben" />
  </order>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="Bnf">
  <tables>
    <tbl name="EmpDep" />
    <tbl name="EmpBen" join="RIGHT" to="EmpDep">
      <eq>
        <fld name="EmpDep.Emp" />
        <fld name="EmpBen.Emp" />
      </eq>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBen.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="PlnTyp.PlnTyp" />
        <fld name="BenPln.PlanType" />
      </eq>
    </tbl>
    <tbl name="EmpBenBnf" main="Yes" join="LEFT">
      <and>
        <eq>
          <fld name="EmpBenBnf.Emp" />
          <fld name="EmpBen.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenBnf.Ben" />
          <fld name="EmpBen.Ben" />
        </eq>
        <eq>
          <fld name="EmpBenBnf.Emp" />
          <fld name="EmpDep.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenBnf.BnfNum" />
          <fld name="EmpDep.Dep" />
        </eq>
<!-- <eq>
              <fld name="EmpDep.Beneficiary" type="YesNo" />
              <val type="YesNo">Yes</val>
            </eq>
            <eq>
              <fld name="EmpBenBnf.EmpBenBnfEfdDt" type="DateTime" />
              <val />
            </eq> -->
<!-- 71348-SK-NV - Logic added -->
        <le>
          <fld name="EmpBenBnf.EmpBenBnfEffDt" type="datetime" />
          <val type="datetime">[DateTime]</val>
        </le>
        <or>
          <isnull>
            <fld name="EmpBenBnf.EmpBenBnfEfdDt" />
          </isnull>
          <ge>
            <fld name="EmpBenBnf.EmpBenBnfEfdDt" type="datetime" />
            <val type="datetime">[DateTime]</val>
          </ge>
        </or>
<!-- 71348-SK-NV - End of logic -->
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="EmpDep.Emp" />
    <fld name="EmpBen.Eml" />
    <fld name="EmpBen.Ben" />
    <fld name="EmpBen.EmpBenEffDt" />
    <fld name="EmpDep.Dep" />
    <fld name="EmpDep.Beneficiary" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00'+Convert(varchar(15),PlnTyp.PlnOrd),3)
        ]]>
      </native>
    </fld>
    <fld name="EnrSum.EnrSum" />
    <fld name="BnfPct" />
    <fld name="Contingency" />
    <fld name="EmpBenBnfEfdDt" />
    <fld name="EmpBenBnf.EmpBenBnfId" />
    <fld name="EmpBenBnf.EmpBenBnfDt" />
    <fld name="EmpBenBnf.BnfNum" />
    <fld name="BnfName">
      <append>
        <fld name="EmpDep.DepLastName" type="String" />
        <val>, </val>
        <fld name="EmpDep.DepFirstName" type="String" />
      </append>
    </fld>
    <fld name="BnfSelect">
      <native lang="SQLServer">
        <![CDATA[
              CASE WHEN NOT EmpBenBnf.BnfNum IS NULL AND (EmpBenBnf.EmpBenBnfEfdDt IS NULL OR EmpBenBnf.EmpBenBnfEfdDt >= GetDate())
                   THEN 'Yes' ELSE 'No' END 
        ]]>
      </native>
    </fld>
  </display>
  <where>
    <and>
      <le>
        <fld name="EnrStartDt" type="datetime" />
        <val>[Date]</val>
      </le>
      <ge>
        <fld name="EnrEndDt" type="datetime" />
        <val>[Date]</val>
      </ge>
      <eq>
        <fld name="EmpDep.Emp" type="String" />
        <val>[fld_main.Emp]</val>
      </eq>
      <or>
        <eq>
          <fld name="EmpDep.Beneficiary" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
        <and>
          <le>
            <fld name="EmpBenBnf.EmpBenBnfEffDt" type="datetime" />
            <val type="datetime">[DateTime]</val>
          </le>
          <or>
            <isnull>
              <fld name="EmpBenBnf.EmpBenBnfEfdDt" />
            </isnull>
            <ge>
              <fld name="EmpBenBnf.EmpBenBnfEfdDt" type="datetime" />
              <val type="datetime">[DateTime]</val>
            </ge>
          </or>
        </and>
      </or>
      <eq>
        <fld name="BenPln.BenAllow" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <or>
        <isnull>
          <fld name="EmpBenEfdDt" />
        </isnull>
        <ge>
          <fld name="EmpBenEfdDt" type="datetime" />
          <val>[Date]</val>
        </ge>
      </or>
    </and>
  </where>
  <order>
    <fld name="EmpBen.Emp" />
    <fld name="Ben.EnrSum" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBen.Ben" />
    <fld name="EmpDep.Dep" />
  </order>
  <synchronize dataset="main">
    <if>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Bnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Bnf.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Bnf.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Bnf.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Bnf.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Keep</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Bnf.Emp]</val>
          </eq>
          <gt>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Bnf.EnrSum]</val>
          </gt>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Bnf.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Bnf.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Bnf.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Bnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Bnf.EnrSum]</val>
          </eq>
          <gt>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Bnf.PlnOrd]</val>
          </gt>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Bnf.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Bnf.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Bnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Bnf.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Bnf.PlnOrd]</val>
          </eq>
          <gt>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Bnf.PlnTyp]</val>
          </gt>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Bnf.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Bnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Bnf.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Bnf.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Bnf.PlnTyp]</val>
          </eq>
          <gt>
            <val>[fld_main.Ben]</val>
            <val>[fld_Bnf.Ben]</val>
          </gt>
        </and>
      </when>
      <then>Skip</then>
      <else>Stop</else>
    </if>
  </synchronize>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="Dep">
  <tables>
    <tbl name="EmpDep" />
    <tbl name="EmpBen" join="RIGHT" to="EmpDep">
      <eq>
        <fld name="EmpDep.Emp" />
        <fld name="EmpBen.Emp" />
      </eq>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBen.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="PlnTyp.PlnTyp" />
        <fld name="BenPln.PlanType" />
      </eq>
    </tbl>
    <tbl name="EmpBenDep" main="Yes" join="LEFT">
      <and>
        <eq>
          <fld name="EmpBenDep.Emp" />
          <fld name="EmpBen.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenDep.Ben" />
          <fld name="EmpBen.Ben" />
        </eq>
        <eq>
          <fld name="EmpBenDep.Emp" />
          <fld name="EmpDep.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenDep.Dep" />
          <fld name="EmpDep.Dep" />
        </eq>
        <eq>
          <fld name="EmpDep.Dependent" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
        <eq>
          <fld name="EmpDep.BenPart" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
        <eq>
          <fld name="EmpBenDep.EmpBenDepEfdDt" type="DateTime" />
          <val />
        </eq>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="EmpDep.Emp" />
    <fld name="EnrSum.EnrSum" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00'+Convert(varchar(15),PlnTyp.PlnOrd),3)
        ]]>
      </native>
    </fld>
    <fld name="EmpBen.Eml" />
    <fld name="EmpBen.Ben" />
    <fld name="EmpBen.EmpBenEffDt" />
    <fld name="EmpDep.Dep" />
    <fld name="EmpBenDep.DepPhysician" />
    <fld name="EmpBenDepEffDt">
      <native lang="SQLServer">
        <![CDATA[
          CASE WHEN EmpBenDepId IS NULL THEN EmpBenEffDt ELSE EmpBenDepEffDt END
        ]]>
      </native>
    </fld>
    <fld name="EmpBenDepEfdDt" origname="EmpBen.EmpBenEfdDt" />
    <fld name="DepBenStartDt">
      <native lang="SQLServer">
        <![CDATA[
          CASE WHEN EmpBenDepId IS NULL THEN EmpBenEffDt ELSE EmpBenDepEffDt END
        ]]>
      </native>
    </fld>
    <fld name="DepBenEndDt" />
    <fld name="EmpBenDep.EmpBenDepId" />
    <fld name="EmpBenDep.EmpBenDepDt" />
    <fld name="DepName">
      <append>
        <fld name="EmpDep.DepLastName" type="String" />
        <val>, </val>
        <fld name="EmpDep.DepFirstName" type="String" />
      </append>
    </fld>
    <fld name="DepSelect">
      <native lang="SQLServer">
        <![CDATA[
              CASE WHEN NOT EmpBenDep.Dep IS NULL AND EmpBenDep.EmpBenDepEfdDt IS NULL THEN 'Yes'
                   ELSE 'No' END
        ]]>
      </native>
    </fld>
  </display>
  <where>
    <and xml="keep">
      <le>
        <fld name="EnrStartDt" type="datetime" />
        <val>[Date]</val>
      </le>
      <ge>
        <fld name="EnrEndDt" type="datetime" />
        <val>[Date]</val>
      </ge>
      <eq>
        <fld name="EmpDep.Emp" type="String" />
        <val>[fld_main.Emp]</val>
      </eq>
      <eq>
        <fld name="EmpDep.Dependent" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <eq>
        <fld name="EmpDep.BenPart" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <eq>
        <fld name="BenPln.DepAllow" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <or>
        <isnull>
          <fld name="EmpBenEfdDt" />
        </isnull>
        <ge>
          <fld name="EmpBenEfdDt" type="datetime" />
          <val>[Date]</val>
        </ge>
      </or>
    </and>
  </where>
  <order>
    <fld name="EmpBen.Emp" />
    <fld name="Ben.EnrSum" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBen.Ben" />
    <fld name="EmpDep.Dep" />
  </order>
  <synchronize dataset="main">
    <if>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Dep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Dep.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Dep.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Dep.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Dep.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Keep</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Dep.Emp]</val>
          </eq>
          <gt>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Dep.EnrSum]</val>
          </gt>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Dep.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Dep.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Dep.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Dep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Dep.EnrSum]</val>
          </eq>
          <gt>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Dep.PlnOrd]</val>
          </gt>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Dep.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Dep.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Dep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Dep.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Dep.PlnOrd]</val>
          </eq>
          <gt>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Dep.PlnTyp]</val>
          </gt>
          <eq>
            <val>[fld_main.Ben]</val>
            <val>[fld_Dep.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Skip</then>
      <when>
        <and>
          <eq>
            <val>[fld_main.Emp]</val>
            <val>[fld_Dep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_main.EnrSum]</val>
            <val>[fld_Dep.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnOrd]</val>
            <val>[fld_Dep.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_main.PlnTyp]</val>
            <val>[fld_Dep.PlnTyp]</val>
          </eq>
          <gt>
            <val>[fld_main.Ben]</val>
            <val>[fld_Dep.Ben]</val>
          </gt>
        </and>
      </when>
      <then>Skip</then>
      <else>Stop</else>
    </if>
  </synchronize>
  <includehistory>Yes</includehistory>
</dataset>
<!-- 36177-LM-NV added for Pending Benefits Section -->
<dataset name="PendBen">
  <tables>
    <tbl name="Emp" />
    <tbl name="EmpBenElg" join="RIGHT" to="Emp" main="Yes">
      <and>
        <eq>
          <fld name="Emp.Emp" />
          <fld name="EmpBenElg.Emp" />
        </eq>
        <isnull>
          <fld name="EmpBenElg.EmpBenElgEfdDt" />
        </isnull>
        <eq>
          <fld name="EmpBenElg.Chosen" type="YesNo" />
          <val>Yes</val>
        </eq>
        <eq>
          <fld name="EmpBenElg.PendBen" type="YesNo" />
          <val>Yes</val>
        </eq>
      </and>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBenElg.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="BenPln.PlanType" />
        <fld name="PlnTyp.PlnTyp" />
      </eq>
    </tbl>
  </tables>
  <display>
    <fld name="EmpBenElg.*" />
    <fld name="EnrSum.EnrSum" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00' + Convert(varchar(15), PlnTyp.PlnOrd), 3)
        ]]>
      </native>
    </fld>
    <fld name="PlnTyp.PlnTypName" />
    <fld name="PlnTyp.PlnTypDesc" />
    <fld name="Ben.BenName" />
    <fld name="Ben.IsEmpPremEmpAmt" />
    <fld name="Ben.IsEmpCovEmpAmt" />
    <fld name="Ben.IsCmpPremEmpAmt" />
    <fld name="Ben.IsCmpCovEmpAmt" />
    <fld name="Ben.IsTotPremEmpAmt" />
    <fld name="Ben.IsTotCovEmpAmt" />
    <fld name="Ben.IsFlxCrdEmpAmt" />
    <fld name="EnrSum.EnrStartDt" />
    <fld name="EnrSum.EnrEndDt" />
    <fld name="Ben.BenDesc" />
    <fld name="BenPln.DescLnk" />
    <fld name="BenPln.InsCar" />
    <fld name="BenPln.FSAAllow" />
    <fld name="BenPln.FSADepAllow" />
    <fld name="BenPln.DepAllow" />
    <fld name="BenPln.BenAllow" />
    <fld name="BenPln.ClmAllow" />
    <fld name="BenPln.UntAllow" />
    <fld name="BenPln.PCPAllow" />
  </display>
  <where>
    <and>
      <le>
        <fld name="EnrStartDt" type="datetime" />
        <val>[Date]</val>
      </le>
      <ge>
        <fld name="EnrEndDt" type="datetime" />
        <val>[Date]</val>
      </ge>
    </and>
  </where>
  <pfind>[F_NavPfind]</pfind>
  <order>
    <fld name="EmpBenElg.Emp" />
    <fld name="Ben.EnrSum" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBenElg.Ben" />
  </order>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="PendBenBnf">
  <tables>
    <tbl name="EmpDep" />
    <tbl name="EmpBenElg" join="RIGHT" to="EmpDep">
      <and>
        <eq>
          <fld name="EmpDep.Emp" />
          <fld name="EmpBenElg.Emp" />
        </eq>
        <isnull>
          <fld name="EmpBenElg.EmpBenElgEfdDt" />
        </isnull>
        <eq>
          <fld name="EmpBenElg.Chosen" type="YesNo" />
          <val>Yes</val>
        </eq>
        <eq>
          <fld name="EmpBenElg.PendBen" type="YesNo" />
          <val>Yes</val>
        </eq>
      </and>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBenElg.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="PlnTyp.PlnTyp" />
        <fld name="BenPln.PlanType" />
      </eq>
    </tbl>
    <tbl name="EmpBenElgBnf" main="Yes" join="LEFT">
      <and>
        <eq>
          <fld name="EmpBenElgBnf.Emp" />
          <fld name="EmpBenElg.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenElgBnf.Ben" />
          <fld name="EmpBenElg.Ben" />
        </eq>
        <eq>
          <fld name="EmpBenElgBnf.Emp" />
          <fld name="EmpDep.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenElgBnf.BnfNum" />
          <fld name="EmpDep.Dep" />
        </eq>
        <eq>
          <fld name="EmpDep.Beneficiary" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="EmpDep.Emp" />
    <fld name="EmpBenElg.Eml" />
    <fld name="EmpBenElg.Ben" />
    <fld name="EmpDep.Dep" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00' + Convert(varchar(15), PlnTyp.PlnOrd), 3)
        ]]>
      </native>
    </fld>
    <fld name="EnrSum.EnrSum" />
    <fld name="BnfPct" />
    <fld name="Contingency" />
    <fld name="EmpBenElgBnfEfdDt" />
    <fld name="EmpBenElgBnf.EmpBenElgBnfId" />
    <fld name="EmpBenElgBnf.EmpBenElgBnfDt" />
    <fld name="EmpBenElgBnf.BnfNum" />
    <fld name="BnfName">
      <append>
        <fld name="EmpDep.DepLastName" type="String" />
        <val>, </val>
        <fld name="EmpDep.DepFirstName" type="String" />
      </append>
    </fld>
    <fld name="BnfSelect">
      <native lang="SQLServer">
            CASE WHEN NOT EmpBenElgBnf.BnfNum IS NULL AND EmpBenElgBnf.EmpBenElgBnfEfdDt IS NULL THEN 'Yes' ELSE 'No' END 
          </native>
    </fld>
  </display>
  <where>
    <and>
      <le>
        <fld name="EnrStartDt" type="datetime" />
        <val>[Date]</val>
      </le>
      <ge>
        <fld name="EnrEndDt" type="datetime" />
        <val>[Date]</val>
      </ge>
      <eq>
        <fld name="EmpDep.Emp" type="String" />
        <val>[fld_PendBen.Emp]</val>
      </eq>
      <eq>
        <fld name="EmpDep.Beneficiary" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <eq>
        <fld name="BenPln.BenAllow" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
    </and>
  </where>
  <order>
    <fld name="EmpBenElg.Emp" />
    <fld name="Ben.EnrSum" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBenElg.Ben" />
    <fld name="EmpDep.Dep" />
  </order>
  <synchronize dataset="PendBen">
    <if>
      <when>
        <and>
          <eq>
            <val>[fld_PendBen.Emp]</val>
            <val>[fld_PendBenBnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.EnrSum]</val>
            <val>[fld_PendBenBnf.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.PlnOrd]</val>
            <val>[fld_PendBenBnf.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.PlnTyp]</val>
            <val>[fld_PendBenBnf.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.Ben]</val>
            <val>[fld_PendBenBnf.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Keep</then>
      <when>
        <and>
          <eq>
            <val>[fld_PendBen.Emp]</val>
            <val>[fld_PendBenBnf.Emp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.EnrSum]</val>
            <val>[fld_PendBenBnf.EnrSum]</val>
          </eq>
          <or>
            <ne>
              <val>[fld_PendBen.PlnOrd]</val>
              <val>[fld_PendBenBnf.PlnOrd]</val>
            </ne>
            <ne>
              <val>[fld_PendBen.PlnTyp]</val>
              <val>[fld_PendBenBnf.PlnTyp]</val>
            </ne>
            <ne>
              <val>[fld_PendBen.Ben]</val>
              <val>[fld_PendBenBnf.Ben]</val>
            </ne>
          </or>
        </and>
      </when>
      <then>Stop</then>
      <else>Skip</else>
    </if>
  </synchronize>
  <includehistory>Yes</includehistory>
</dataset>
<!-- 36177-LM-NV dependents for pending benefits -->
<dataset name="PendBenDep">
  <tables>
    <tbl name="EmpDep" />
    <tbl name="EmpBenElg" join="RIGHT" to="EmpDep">
      <and>
        <eq>
          <fld name="EmpDep.Emp" />
          <fld name="EmpBenElg.Emp" />
        </eq>
        <isnull>
          <fld name="EmpBenElg.EmpBenElgEfdDt" />
        </isnull>
        <eq>
          <fld name="EmpBenElg.Chosen" type="YesNo" />
          <val>Yes</val>
        </eq>
        <eq>
          <fld name="EmpBenElg.PendBen" type="YesNo" />
          <val>Yes</val>
        </eq>
      </and>
    </tbl>
    <tbl name="Ben" join="LEFT">
      <eq>
        <fld name="Ben.Ben" />
        <fld name="EmpBenElg.Ben" />
      </eq>
    </tbl>
    <tbl name="EnrSum" join="LEFT">
      <eq>
        <fld name="Ben.EnrSum" />
        <fld name="EnrSum.EnrSum" />
      </eq>
    </tbl>
    <tbl name="BenPln" join="LEFT">
      <eq>
        <fld name="BenPln.BenPln" />
        <fld name="Ben.BenPln" />
      </eq>
    </tbl>
    <tbl name="PlnTyp" join="LEFT">
      <eq>
        <fld name="PlnTyp.PlnTyp" />
        <fld name="BenPln.PlanType" />
      </eq>
    </tbl>
    <tbl name="EmpBenElgDep" main="Yes" join="LEFT">
      <and>
        <eq>
          <fld name="EmpBenElgDep.Emp" />
          <fld name="EmpBenElg.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenElgDep.Ben" />
          <fld name="EmpBenElg.Ben" />
        </eq>
        <eq>
          <fld name="EmpBenElgDep.Emp" />
          <fld name="EmpDep.Emp" />
        </eq>
        <eq>
          <fld name="EmpBenElgDep.Dep" />
          <fld name="EmpDep.Dep" />
        </eq>
        <eq>
          <fld name="EmpDep.Dependent" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
        <eq>
          <fld name="EmpDep.BenPart" type="YesNo" />
          <val type="YesNo">Yes</val>
        </eq>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="EmpDep.Emp" />
    <fld name="EmpBenElg.Eml" />
    <fld name="EnrSum.EnrSum" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="PlnTyp.PlnOrd">
      <native lang="SQLServer">
        <![CDATA[
              RIGHT('00' + Convert(varchar(15), PlnTyp.PlnOrd), 3)
        ]]>
      </native>
    </fld>
    <fld name="EmpBenElg.Ben" />
    <fld name="EmpDep.Dep" />
    <fld name="DepPhysician" />
    <fld name="EmpBenElgDepEffDt" />
    <fld name="EmpBenElgDepEfdDt" />
    <fld name="DepBenStartDt" />
    <fld name="DepBenEndDt" />
    <fld name="EmpBenElgDep.EmpBenElgDepId" />
    <fld name="EmpBenElgDep.EmpBenElgDepDt" />
    <fld name="DepName">
      <append>
        <fld name="EmpDep.DepLastName" type="String" />
        <val>, </val>
        <fld name="EmpDep.DepFirstName" type="String" />
      </append>
    </fld>
    <fld name="DepSelect">
      <native lang="SQLServer">CASE WHEN NOT EmpBenElgDep.Dep IS NULL AND EmpBenElgDep.EmpBenElgDepEfdDt IS NULL THEN 'Yes' ELSE 'No' END</native>
    </fld>
  </display>
  <where>
    <and xml="keep">
      <le>
        <fld name="EnrStartDt" type="datetime" />
        <val>[Date]</val>
      </le>
      <ge>
        <fld name="EnrEndDt" type="datetime" />
        <val>[Date]</val>
      </ge>
      <eq>
        <fld name="EmpDep.Emp" type="String" />
        <val>[fld_PendBen.Emp]</val>
      </eq>
      <eq>
        <fld name="EmpDep.Dependent" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <eq>
        <fld name="EmpDep.BenPart" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
      <eq>
        <fld name="BenPln.DepAllow" type="YesNo" />
        <val type="YesNo">Yes</val>
      </eq>
    </and>
  </where>
  <order>
    <fld name="EmpBenElg.Emp" />
    <fld name="Ben.EnrSum" />
    <fld name="PlnTyp.PlnOrd" />
    <fld name="PlnTyp.PlnTyp" />
    <fld name="EmpBenElg.Ben" />
    <fld name="EmpDep.Dep" />
  </order>
  <synchronize dataset="PendBen">
    <if>
      <when>
        <and>
          <eq>
            <val>[fld_PendBen.Emp]</val>
            <val>[fld_PendBenDep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.EnrSum]</val>
            <val>[fld_PendBenDep.EnrSum]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.PlnOrd]</val>
            <val>[fld_PendBenDep.PlnOrd]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.PlnTyp]</val>
            <val>[fld_PendBenDep.PlnTyp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.Ben]</val>
            <val>[fld_PendBenDep.Ben]</val>
          </eq>
        </and>
      </when>
      <then>Keep</then>
      <when>
        <and>
          <eq>
            <val>[fld_PendBen.Emp]</val>
            <val>[fld_PendBenDep.Emp]</val>
          </eq>
          <eq>
            <val>[fld_PendBen.EnrSum]</val>
            <val>[fld_PendBenDep.EnrSum]</val>
          </eq>
          <or>
            <ne>
              <val>[fld_PendBen.PlnOrd]</val>
              <val>[fld_PendBenDep.PlnOrd]</val>
            </ne>
            <ne>
              <val>[fld_PendBen.PlnTyp]</val>
              <val>[fld_PendBenDep.PlnTyp]</val>
            </ne>
            <ne>
              <val>[fld_PendBen.Ben]</val>
              <val>[fld_PendBenDep.Ben]</val>
            </ne>
          </or>
        </and>
      </when>
      <then>Stop</then>
      <else>Skip</else>
    </if>
  </synchronize>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="BnfUpdate">
  <tables>
    <tbl name="EmpBenBnf" main="Yes" />
  </tables>
  <display>
    <fld name="Emp" key="Yes" />
    <fld name="Eml" key="Yes" />
    <fld name="Ben" key="Yes" />
    <fld name="BnfNum" key="Yes" />
    <fld name="EmpBenBnfEffDt" key="Yes" />
    <fld name="Contingency" />
    <fld name="BnfPct" />
  </display>
</dataset>
<dataset name="DepUpdate">
  <tables>
    <tbl name="EmpBenDep" main="Yes" />
  </tables>
  <display>
    <fld name="Emp" key="Yes" />
    <fld name="Eml" key="Yes" />
    <fld name="Ben" key="Yes" />
    <fld name="Dep" key="Yes" />
    <fld name="EmpBenDepEffDt" key="Yes" />
    <fld name="DepPhysician" />
    <fld name="DepBenEligibleDt" />
    <fld name="DepBenStartDt" />
  </display>
</dataset>
<dataset name="PendBenUpdate">
  <tables>
    <tbl name="EmpBenElg" main="Yes" />
  </tables>
  <display>
    <fld name="EmpBenElgId" key="Yes" />
    <fld name="PendBen" type="YesNo" />
    <fld name="Units" />
  </display>
</dataset>
<dataset name="PendBenBnfUpdate">
  <tables>
    <tbl name="EmpBenElgBnf" main="Yes" />
  </tables>
  <display>
    <fld name="EmpBenElgBnfId" key="Yes" />
    <fld name="Emp" key="Yes" />
    <fld name="Eml" key="Yes" />
    <fld name="Ben" key="Yes" />
    <fld name="BnfNum" key="Yes" />
    <fld name="EmpBenElgBnfEffDt" />
    <fld name="Contingency" />
    <fld name="BnfPct" />
  </display>
</dataset>
<dataset name="PendBenDepUpdate">
  <tables>
    <tbl name="EmpBenElgDep" main="Yes" />
  </tables>
  <display>
    <fld name="EmpBenElgDepId" key="Yes" />
    <fld name="Emp" key="Yes" />
    <fld name="Eml" key="Yes" />
    <fld name="Ben" key="Yes" />
    <fld name="Dep" key="Yes" />
    <fld name="EmpBenElgDepEffDt" />
    <fld name="DepPhysician" />
    <fld name="DepBenEligibleDt" />
  </display>
</dataset>
<!-- Dataset Definition Block Starts -->
<!-- View Definition Block Starts -->
<view name="list">
<!-- Include Header Control Definitions -->
  <script name="EmpHeaderCtls" />
<!-- 47409-LM-NV: Eml Header Controls script added -->
  <script name="EmlHeaderCtls" />
<!-- Form Control Display Logic Starts -->
  <display>
    <title>Employee Current Enrollment Benefits Dependents / Beneficiaries Details</title>
    <instructions>Choose Dependents / Beneficiaries</instructions>
    <head />
    <toolbar>
      <save />
    </toolbar>
    <body>
      <set var="[NoSelection]">Yes</set>
<!-- Controls Display Using main Dataset Starts -->
      <datasheet dataset="main" headers="TOP" showlinecount="No">
<!-- Header Controls Display Starts -->
        <groups>
          <groupby val="[fld_EmpCde]">
            <header>
              <row>
                <col span="3">[ctl_FullName][ctl_Emp][ctl_ProfilePopup]</col>
              </row>
            </header>
          </groupby>
          <groupby val="[fld_EnrSum]">
            <if>
              <when>
                <and>
                  <ne>
                    <val>[fld_EnrSum]</val>
                    <val />
                  </ne>
                  <ne>
                    <val>[fld_PlnTyp]</val>
                    <val />
                  </ne>
                </and>
              </when>
              <then>
                <header xml="keep">
                  <row>
                    <col span="6">[ctl_EnrSum]</col>
                  </row>
                </header>
              </then>
            </if>
          </groupby>
<!-- 
                # 47409-LM-NV: Groupby Eml header for benefit screens added
              -->
          <script name="BenFrmEmlHdrGrp" />
          <groupby val="[fld_PlnTyp]">
            <if>
              <when>
                <ne>
                  <val>[fld_PlnTyp]</val>
                  <val />
                </ne>
              </when>
              <then>
                <header>
                  <row>
                    <col span="6">[ctl_PlnTypName]</col>
                  </row>
                  <if when="[fld_PlnTypDesc]">
                    <row>
                      <col span="6">[ctl_PlnTypDesc]</col>
                    </row>
                  </if>
                </header>
              </then>
            </if>
          </groupby>
        </groups>
<!-- When main.PlnTyp Is Not NULL, Display Controls -->
        <if>
          <when>
            <ne>
              <val>[fld_PlnTyp]</val>
              <val />
            </ne>
          </when>
          <then>
            <row>
<!-- Initialize Variables -->
              <set var="[ExtraColumns]">8</set>
              <set var="[BenStDt]">[fld_main.EmpBenEffDt]</set>
<!-- Display Controls -->
              <col>[ctl_BenName]</col>
              <col>[ctl_BenEffectiveDt]</col>
<!-- MORAN 2-1-2012 <col>[ctl_EmpBenDedStartDt]</col>
              <col>[ctl_EmpBenDedEndDt]</col> -->
              <col>[ctl_InsCar]</col>
<!--
                    # When main.IsCmpCovEmpAmt = Yes,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ Display Editable Control CmpCov
                    # Else,
                      $ When main.CmpCov Is Greater Than 0,
                        @ Set Variable ExtraColumns = ExtraColumns - 1
                        @ Display ReadOnly Control CmpCovLbl
                  -->
              <if>
<!-- Case When main.IsCmpCovEmpAmt = Yes -->
                <when>
                  <eq>
                    <val>[fld_main.IsCmpCovEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
<!-- Display Editable Control CmpCov -->
                  <col align="RIGHT">[ctl_CmpCov]</col>
                </then>
                <else>
                  <if>
<!-- When main.CmpCov Is Not Equal To 0 -->
                    <when>
                      <ne>
                        <val type="Number">[fld_main.CmpCov]</val>
                        <val type="Number">0</val>
                      </ne>
                    </when>
                    <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
<!-- Display ReadOnly Control CmpCovLbl -->
                      <col align="RIGHT">[ctl_CmpCovLbl]</col>
                    </then>
                  </if>
                </else>
              </if>
<!--
                    # When main.IsEmpCovEmpAmt = Yes,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ Display Editable Control EmpCov
                    # Else,
                      $ When main.EmpCov Is NotEqual To 0,
                        @ Set Variable ExtraColumns = ExtraColumns - 1
                        @ Display ReadOnly Control EmpCovLbl
                  -->
              <if>
<!-- When main.IsEmpCovEmpAmt = Yes -->
                <when>
                  <eq>
                    <val>[fld_main.IsEmpCovEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
<!-- Display Editable Control EmpCov -->
                  <col align="RIGHT">[ctl_EmpCov]</col>
                </then>
                <else>
                  <if>
<!-- When main.EmpCov Is Not Equal To 0 -->
                    <when>
                      <ne>
                        <val>[fld_main.EmpCov]</val>
                        <val>0</val>
                      </ne>
                    </when>
                    <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
<!-- Display Editable Control EmpCov -->
                      <col align="RIGHT">[ctl_EmpCovLbl]</col>
                    </then>
                  </if>
                </else>
              </if>
<!-- Display Control EmpPayDedAmt -->
              <col align="RIGHT">[ctl_EmpPayPdDed]</col>
<!--
                    # When F_Application = ESS,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ When main.IsCmpPremEmpAmt = Yes, Display Editable Control EmpPrem
                      $ Else, Display Editable Control EmpPremLbl
                  -->
              <if>
                <when>
                  <ne>
                    <val>[F_Application]</val>
                    <val>ESS</val>
                  </ne>
                </when>
                <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
                  <if>
<!-- Case When main.IsCmpPremEmpAmt = Yes -->
                    <when>
                      <eq>
                        <val>[fld_main.IsCmpPremEmpAmt]</val>
                        <val>Yes</val>
                      </eq>
                    </when>
                    <then>
<!-- Display Editable Control EmpPrem -->
                      <col align="RIGHT">[ctl_CmpPrem]</col>
                    </then>
                    <else>
<!-- Display ReadOnly Control EmpPremLbl -->
                      <col align="RIGHT">[ctl_CmpPremLbl]</col>
                    </else>
                  </if>
                </then>
              </if>
<!--
                    # When main.IsEmpPremEmpAmt = Yes, Display Editable Control EmpPrem
                    # Else, Display ReadOnly Control EmpPremLbl
                  -->
              <if>
<!-- Case When main.IsEmpPremEmpAmt = Yes -->
                <when>
                  <eq>
                    <val>[fld_main.IsEmpPremEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
<!-- Display Editable Control EmpPrem -->
                  <col align="RIGHT">[ctl_EmpPrem]</col>
                </then>
                <else>
<!-- Display ReadOnly Control EmpPremLbl -->
                  <col align="RIGHT">[ctl_EmpPremLbl]</col>
                </else>
              </if>
<!--
                    # When main.IsFlxCrdAmt = Yes,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ Display Editable Control FlexCredits
                    # Else,
                      $ When main.FlexCredits Is Greater Than 0,
                        @ Set Variable ExtraColumns = ExtraColumns - 1
                        @ Display ReadOnly Control FlexCreditsLbl
                  -->
              <if>
<!-- Case When main.IsFlxCrdAmt = Yes -->
                <when>
                  <eq>
                    <val>[fld_main.IsFlxCrdEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
<!-- Display Editable Control FlexCredits -->
                  <col align="RIGHT">[ctl_FlexCredits]</col>
                </then>
                <else>
                  <if>
<!-- Case When main.FlexCredits Is NOt Rqual To 0 -->
                    <when>
                      <ne>
                        <val>[fld_main.FlexCredits]</val>
                        <val>0</val>
                      </ne>
                    </when>
                    <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
<!-- Display Editable Control FlexCreditsLbl -->
<!-- MORAN 2-1-2012 <col align="RIGHT">[ctl_FlexCreditsLbl]</col> -->
                    </then>
                  </if>
                </else>
              </if>
<!--
                    # When main.FSAAllow Is Not NULL,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ When F_Application = ESS, Display ReadOnly Control AnnElectAmtLabel
                      $ Else, Display Editable Control AnnlElectAmt
                  -->
              <if when="[fld_main.FSAAllow]">
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <if>
<!-- Case When F_Application = ESS -->
                  <when>
                    <eq>
                      <val>[F_Application]</val>
                      <val>ESS</val>
                    </eq>
                  </when>
                  <then>
<!-- Display ReadOnly Control AnnElectAmtLabel -->
                    <col>[ctl_AnnElectAmtLabel]</col>
                  </then>
                  <else>
<!-- Display Editable Control AnnlElectAmt -->
                    <col>[ctl_AnnElectAmt]</col>
                  </else>
                </if>
<!-- Display Control PayrollDeduction -->
                <col>[ctl_PayrollDeduction]</col>
              </if>
<!-- 36177-LN-NV -->
<!--
                    # When main.FSADepAllow Is Not NULL,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ When F_Application = ESS, Display ReadOnly Control
                      $ Else, Display Editable Control DepAnnlElectAmt
                  -->
              <if when="[fld_main.FSADepAllow]">
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <if>
<!-- Case When F_Application = ESS -->
                  <when>
                    <eq>
                      <val>[F_Application]</val>
                      <val>ESS</val>
                    </eq>
                  </when>
                  <then>
                    <col>[ctl_DepAnnElectAmtLabel]</col>
                  </then>
                  <else>
                    <col>[ctl_DepAnnElectAmt]</col>
                  </else>
                </if>
              </if>
<!--
                    # When main.UntAllow Is Not Null,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ Display Control Units
                  -->
              <if when="[fld_main.UntAllow]">
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
<!-- Display Control Units -->
                <col align="RIGHT">[ctl_Units]</col>
              </if>
<!--
                    # When main.PCPAllow Is Not Null,
                      $ Set Variable ExtraColumns = ExtraColumns - 1
                      $ Display Control Physician
                  -->
              <if when="[fld_main.PCPAllow]">
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
<!-- Display Control Physician -->
                <col>[ctl_Physician]</col>
              </if>
<!-- When ExtraColumns Is Greater Than 0, Display Column With span = ExtraColumns -->
              <if>
<!-- Case When ExtraColumns Is Greater Than 0 -->
                <when>
                  <gt>
                    <val>[ExtraColumns]</val>
                    <val>0</val>
                  </gt>
                </when>
                <then>
<!-- Display Column With span = ExtraColumns -->
                  <col span="[ExtraColumns]" />
                </then>
              </if>
            </row>
<!--
                  # When main.DepAllow Is Not NULL, 
                    $ Set Variable isPCPAllow To NULL
                    $ When main.PCPAllow Is Not NULL,
                      @ Set Variable isPCPAllow = Yes
                    $ Display Dependent Rows
                -->
            <if when="[fld_main.DepAllow]">
<!-- Set Variable isPCPAllow To NULL -->
              <set var="[isPCPAllow]" />
<!-- Case When main.PCPAllow Is Not NULL -->
              <if when="[fld_main.PCPAllow]">
<!-- Set isPCPAllow = Yes -->
                <set var="[isPCPAllow]">Yes</set>
              </if>
              <row>
                <col span="10">
<!-- Display Dependent Rows Using Dep Dataset -->
                  <set var="[VarEligibleDt]">[fld_main.EligibleDt]</set>
                  <datasheet dataset="Dep" headers="TOP" showlinecount="No">
                    <set var="[VarElgDepId]">[fld_Dep.EmpBenDepId]</set>
                    <row>
<!-- Display Controls -->
                      <col>[ctl_SysDepSelect][ctl_Dep][ctl_Emp][ctl_Eml][ctl_Ben][ctl_EmpBenDepEffDt][ctl_EmpBenDepEfdDt][ctl_EligibleDt][ctl_SysElgDepId]</col>
                      <col>[ctl_DepName][ctl_DepBenStartDt]</col>
<!--
                            # When isPCPAllow = Yes
                              $ Set Variable ExtraColumns = ExtraColumns - 1
                              $ Display Control DepPhysician
                          -->
                      <if>
<!-- Case When isPCPAllow = Yes -->
                        <when>
                          <eq>
                            <val>[isPCPAllow]</val>
                            <val>Yes</val>
                          </eq>
                        </when>
                        <then>
<!-- Set Variable ExtraColumns = ExtraColumns - 1 -->
                          <set var="[ExtraColumns]">
                            <minus>
                              <val>[ExtraColumns]</val>
                              <val>1</val>
                            </minus>
                          </set>
<!-- Display Column DepPhysician -->
                          <col>[ctl_DepPhysician]</col>
                        </then>
                      </if>
                    </row>
                  </datasheet>
                </col>
              </row>
            </if>
<!-- When main.BenAllow = Yes, Display Beneficiary Rows -->
            <if when="[fld_main.BenAllow]">
              <row>
                <col span="10">
                  <datasheet dataset="Bnf" headers="TOP" showlinecount="No">
                    <set var="[VarElgBnfId]">[fld_Bnf.EmpBenBnfId]</set>
                    <row>
<!-- 71348-SK-NV - Logic added -->
                      <set var="[var_bnfNotSel]">No</set>
                      <if>
                        <when>
                          <eq>
                            <val>[fld_Bnf.Beneficiary]</val>
                            <val>No</val>
                          </eq>
                        </when>
                        <then>
                          <set var="[var_bnfNotSel]">Yes</set>
                          <col />
                        </then>
                        <else>
                          <set var="[var_bnfNotSel]">No</set>
                          <col>[ctl_SysBnfSelect]</col>
                        </else>
                      </if>
                      <col>[ctl_BnfName][ctl_BnfNum][ctl_Emp][ctl_Eml][ctl_Ben][ctl_EmpBenEffDt][ctl_SysElgBnfId]</col>
<!-- 71348-SK-NV - End of Logic -->
                      <col>[ctl_Contingency]</col>
                      <col>[ctl_BnfPct]</col>
                    </row>
                  </datasheet>
                </col>
              </row>
            </if>
<!-- Set Variable NoSelection = No -->
            <set var="[NoSelection]">No</set>
          </then>
<!-- Case When main.PlnTyp = Yes -->
        </if>
      </datasheet>
      <blankline />
      <datasheet dataset="PendBen" headers="TOP" showlinecount="No" title="Pending Benefits">
        <groups>
          <groupby val="[fld_EnrSum]">
            <if>
              <when>
                <ne>
                  <val>[fld_EnrSum]</val>
                  <val />
                </ne>
              </when>
              <then>
                <header>
                  <row>
                    <col>[ctl_EnrSum]</col>
                  </row>
                </header>
              </then>
            </if>
          </groupby>
          <groupby val="[fld_PlnTyp]">
            <if>
              <when>
                <ne>
                  <val>[fld_PlnTyp]</val>
                  <val />
                </ne>
              </when>
              <then>
                <header>
                  <row>
                    <col>[ctl_PlnTypName]</col>
                  </row>
                  <if when="[fld_PlnTypDesc]">
                    <row>
                      <col>[ctl_PlnTypDesc]</col>
                    </row>
                  </if>
                </header>
              </then>
            </if>
          </groupby>
        </groups>
        <if>
          <when>
            <ne>
              <val>[fld_PlnTyp]</val>
              <val />
            </ne>
          </when>
          <then>
            <row>
              <set var="[ExtraColumns]">10</set>
              <if>
                <when>
                  <ne>
                    <val>[F_Application]</val>
                    <val>ESS</val>
                  </ne>
                </when>
                <then>
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
                  <col>[ctl_PendBen]</col>
                </then>
              </if>
              <col>[ctl_BenName][ctl_Emp]</col>
              <col>[ctl_EmpBenElgDedStartDt]</col>
              <col>[ctl_EmpBenElgDedEndDt]</col>
              <col>[ctl_InsCar]</col>
              <if>
                <when>
                  <eq>
                    <val>[fld_PendBen.IsCmpCovEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
                  <col align="RIGHT">[ctl_CmpCov]</col>
                </then>
                <else>
                  <if>
                    <when>
                      <ne>
                        <val type="Number">[fld_PendBen.CmpCov]</val>
                        <val type="Number">0</val>
                      </ne>
                    </when>
                    <then>
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
                      <col align="RIGHT">[ctl_CmpCovLbl]</col>
                    </then>
                  </if>
                </else>
              </if>
              <if>
                <when>
                  <eq>
                    <val>[fld_PendBen.IsEmpCovEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
                  <col align="RIGHT">[ctl_EmpCov]</col>
                </then>
                <else>
                  <if>
                    <when>
                      <ne>
                        <val>[fld_PendBen.EmpCov]</val>
                        <val>0</val>
                      </ne>
                    </when>
                    <then>
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
                      <col align="RIGHT">[ctl_EmpCovLbl]</col>
                    </then>
                  </if>
                </else>
              </if>
              <if>
                <when>
                  <and>
                    <eq>
                      <val>[fld_PendBen.IsCmpPremEmpAmt]</val>
                      <val>Yes</val>
                    </eq>
                    <ne>
                      <val>[F_Application]</val>
                      <val>ESS</val>
                    </ne>
                  </and>
                </when>
                <then>
                  <col align="RIGHT">[ctl_CmpPrem]</col>
                </then>
                <else>
                  <col align="RIGHT">[ctl_CmpPremLbl]</col>
                </else>
              </if>
              <if>
                <when>
                  <and>
                    <eq>
                      <val>[fld_PendBen.IsEmpPremEmpAmt]</val>
                      <val>Yes</val>
                    </eq>
                    <ne>
                      <val>[F_Application]</val>
                      <val>ESS</val>
                    </ne>
                  </and>
                </when>
                <then>
                  <col align="RIGHT">[ctl_EmpPrem]</col>
                </then>
                <else>
                  <col align="RIGHT">[ctl_EmpPremLbl]</col>
                </else>
              </if>
              <if>
                <when>
                  <eq>
                    <val>[fld_PendBen.IsFlxCrdEmpAmt]</val>
                    <val>Yes</val>
                  </eq>
                </when>
                <then>
                  <set var="[ExtraColumns]">
                    <minus>
                      <val>[ExtraColumns]</val>
                      <val>1</val>
                    </minus>
                  </set>
                  <col align="RIGHT">[ctl_FlexCredits]</col>
                </then>
                <else>
                  <if>
                    <when>
                      <ne>
                        <val>[fld_PendBen.FlexCredits]</val>
                        <val>0</val>
                      </ne>
                    </when>
                    <then>
                      <set var="[ExtraColumns]">
                        <minus>
                          <val>[ExtraColumns]</val>
                          <val>1</val>
                        </minus>
                      </set>
<!-- MORAN 2-1-2012 <col align="RIGHT">[ctl_FlexCreditsLbl]</col> -->
                    </then>
                  </if>
                </else>
              </if>
              <if when="[fld_PendBen.FSAAllow]">
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <col>[ctl_AnnElectAmt]</col>
              </if>
              <if when="[fld_PendBen.FSADepAllow]">
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <col>[ctl_DepAnnElectAmt]</col>
              </if>
              <if when="[fld_PendBen.UntAllow]">
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <col align="RIGHT">[ctl_Units]</col>
              </if>
              <if when="[fld_PendBen.PCPAllow]">
                <set var="[ExtraColumns]">
                  <minus>
                    <val>[ExtraColumns]</val>
                    <val>1</val>
                  </minus>
                </set>
                <col>[ctl_Physician]</col>
              </if>
              <if>
                <when>
                  <gt>
                    <val>[ExtraColumns]</val>
                    <val>0</val>
                  </gt>
                </when>
                <then>
                  <col span="[ExtraColumns]" />
                </then>
              </if>
            </row>
            <if when="[fld_PendBen.DepAllow]">
              <row>
                <col span="14">
                  <set var="[VarEligibleDt]">[fld_PendBen.EligibleDt]</set>
                  <datasheet dataset="PendBenDep" headers="TOP" showlinecount="No">
                    <set var="[VarElgDepId]">[fld_PendBenDep.EmpBenElgDepId]</set>
                    <row>
                      <col>[ctl_SysDepSelect][ctl_Dep][ctl_Emp][ctl_Eml][ctl_Ben][ctl_EmpBenElgEffDt][ctl_EligibleDt][ctl_SysElgDepId]</col>
                      <col>[ctl_DepName]</col>
                      <if>
                        <when>
                          <eq>
                            <val>[fld_PendBen.PCPAllow]</val>
                            <val>Yes</val>
                          </eq>
                        </when>
                        <then>
                          <col>[ctl_DepPhysician]</col>
                        </then>
                      </if>
                    </row>
                  </datasheet>
                </col>
              </row>
            </if>
            <if when="[fld_PendBen.BenAllow]">
              <row>
                <col span="14">
                  <datasheet dataset="PendBenBnf" headers="TOP" showlinecount="No">
                    <set var="[VarElgBnfId]">[fld_PendBenBnf.EmpBenElgBnfId]</set>
                    <row>
                      <col>[ctl_SysBnfSelect][ctl_BnfNum][ctl_Emp][ctl_Eml][ctl_Ben][ctl_EmpBenElgEffDt][ctl_SysElgBnfId]</col>
                      <col>[ctl_BnfName]</col>
                      <col>[ctl_Contingency]</col>
                      <col>[ctl_BnfPct]</col>
                    </row>
                  </datasheet>
                </col>
              </row>
            </if>
            <set var="[NoSelection]">No</set>
          </then>
        </if>
      </datasheet>
<!-- If NoSelection = Yes, Display No Selection Message -->
      <if when="[NoSelection]">
        <v>Employee has not chosen any Benefits</v>
      </if>
    </body>
  </display>
</view>
<!-- View Definition Block Ends -->
<!-- Form: EmpBenDepRvw -->