<!-- Client-side Events -->
<event name="global" where="Client">
  <native lang="Javascript">
    <![CDATA[
      if (!NuCtlDatagrid.Datagrid_main_1) {
        NuCtlDatagrid.Datagrid_main_1 = {};
      }
      NuCtlDatagrid.Datagrid_main_1.FormConfig = {
        "sSortOrder" : "EmpAbsCatEffDt_Absence Start Date",
        "sGridGroupBy" : "EmpAbsCatEffDt_Absence Start Date",
        "sSortDirection" : "ASC"
      };
    ]]>
  </native>
</event>
<event name="onChange" ctl="asOfDate" where="Client">
  <native lang="JavaScript">
    <![CDATA[
      var v_dateNew;
      var v_dateStart;
      var v_dateEnd;
      v_dateNew = NuStr.toDate(ctlGetVal("N_asOfDate_main_1"));
      v_dateStart = NuStr.toDate(ctlGetVal("N_EmpAbsCatEffDt_main_1"));
      v_dateEnd = NuStr.toDate(ctlGetVal("N_EmpAbsCatEfdDt_main_1"));

      if (v_dateNew >= v_dateStart) {
      } else if (v_dateNew <= v_dateEnd) {
      } else {
        alert("please select a date between start and end date!");
        ctlSetVal("N_asOfDate_main_1", "");
      }
    ]]>
  </native>
</event>
<event name="onClick" ctl="PrcAsOf" where="Client">
  <native lang="JavaScript">
    <![CDATA[
    var v_sResult;
    var v_hMessage;
    var v_dtAsOf;
    var v_dtStart;
    var v_dtEnd;
    v_dtStart = NuStr.toDate(ctlGetVal("N_EmpAbsCatEffDt_main_1"));
    v_dtEnd = NuStr.toDate(ctlGetVal("N_EmpAbsCatEfdDt_main_1"));
    v_dtAsOf = NuStr.toDate(ctlGetVal("N_asOfDate_main_1"));
    if (NuStr.isBlank(v_dtAsOf)) {
      return;
    } else if (v_dtAsOf < v_dtStart) {
      alert ("The process date is less than the first date of the category!");
      return;
    } else if (v_dtAsOf > v_dtEnd) {
      alert ("The process date is greater than the last date of the category!");
      return;
    }
    v_hMessage = {};
    v_hMessage["F_Value1"] = ctlGetVal("N_Emp_main_1") + ',' + ctlGetVal("N_AbsCat_main_1") + ',' + ctlGetVal("N_asOfDate_main_1");
    v_sResult = NuView.Document.functionCall(v_hMessage);
    ctlSetVal("N_PrcAsOfValue_main_1", v_sResult);
    ]]>
  </native>
</event>
<!-- Server-side Events -->
<event name="beforeFunction" where="Server">
  <foreach dataset="PrcAcc">
    <if>
      <when>
        <ne>
          <val>[fld_IsDbEngine]</val>
          <val>Yes</val>
        </ne>
      </when>
      <then />
      <else />
    </if>
  </foreach>
  <ifnoerror>
    <return>
      <obj>  
        oTcl.set(Tcl)
        oTcl.calBalance([F_Value1])
      </obj>
    </return>
  </ifnoerror>
</event>
<event name="onClick" ctl="PrcAbsCat" where="Server">
  <foreach dataset="PrcAcc">
    <if>
      <when>
        <ne>
          <val>[fld_IsDbEngine]</val>
          <val>Yes</val>
        </ne>
      </when>
      <then>
        <obj>
          oTcl.set(Tcl)
          oTcl.timeAccrualCalc([N_Emp_main_1], [fld_PrcAcc.Eml], [fld_PrcAcc.Tcl], [fld_PrcAcc.EmpTclStartDateRaw], [fld_PrcAcc.EmpTclEndDateRaw])
        </obj>
      </then>
      <else>
        <set var="[EXECSql]">
            EXEC ZZAccrualTask '[N_Emp_main_1]', '[fld_PrcAcc.Tcl]','Update' , null, '[fld_PrcAcc.Eml]', '[fld_PrcAcc.EmpTclStartDateSQL]' , '[fld_PrcAcc.EmpTclEndDateSQL]'
        </set>
        <dataset name="ProcessAccrual" type="SQLSelect">
          <sql>
              [EXECSql]
            </sql>
        </dataset>
        <datasetopen dataset="ProcessAccrual" />
        <datasetclose dataset="ProcessAccrual" />
      </else>
    </if>
  </foreach>
</event>
<event name="onLoad" where="Server">
  <if>
    <when>
      <or>
        <eq>
          <val>[F_Application]</val>
          <val>HR</val>
        </eq>
        <and>
          <eq>
            <val>[F_Application]</val>
            <val>ESS</val>
          </eq>
          <eq>
            <val>[F_Flow]</val>
            <val>Wizards</val>
          </eq>
        </and>
      </or>
    </when>
    <then>
      <set var="[var_Readonly]">No</set>
    </then>
    <else>
      <set var="[var_Readonly]">Yes</set>
    </else>
  </if>
  <set var="[v_sWhereClause]">
    <lookup dataset="IncludeHistoryStatus" />
  </set>
</event>
<!-- Datasets -->
<dataset name="PrcAcc">
  <tables>
    <tbl name="EmpTclCat" main="Yes" />
    <tbl name="Tcl" join="LEFT" to="EmpTclCat">
      <eq>
        <fld name="Tcl.Tcl" />
        <fld name="EmpTclCat.Tcl" />
      </eq>
    </tbl>
    <tbl name="EmpAbsCat" join="LEFT" to="Tcl">
      <eq>
        <fld name="Tcl.AbsCat" />
        <fld name="EmpAbsCat.AbsCat" />
      </eq>
    </tbl>
  </tables>
  <display>
    <fld name="Tcl" origname="EmpTclCat.Tcl" />
    <fld name="EmpTclStartDate">
      <native lang="SQLServer">
       dbo.NuDateToStr(EmpTclStartDate, 'SQL', 'DateOnly')
      </native>
    </fld>
    <fld name="EmpTclStartDateRaw">
      <native lang="SQLServer">
       dbo.NuDateToStr(EmpTclStartDate, 'NuXML', 'DateOnly')
      </native>
    </fld>
    <fld name="EmpTclEndDateSQL">
      <native lang="SQLServer">
       dbo.NuDateToStr(EmpTclEndDate, 'SQL', 'DateOnly')
      </native>
    </fld>
    <fld name="EmpTclEndDateRaw">
      <native lang="SQLServer">
        dbo.NuDateToStr(EmpTclEndDate, 'NuXML', 'DateOnly')
      </native>
    </fld>
    <fld name="EmpTclCat.Eml" />
    <fld name="OrderByDate" origname="EmpTclcat.EmpTclStartDate" type="DateTime" />
    <fld name="Tcl.IsDbEngine" />
    <fld name="EmpAbsCat.AbsCat" />
  </display>
  <where>
    <and>
      <eq>
        <fld name="Tcl.AbsCat" />
        <val>[N_AbsCat_main_1]</val>
      </eq>
      <eq>
        <fld name="EmpTclCat.Emp" />
        <val>[N_Emp_main_1]</val>
      </eq>
      <eq>
        <fld name="EmpAbsCat.Emp" />
        <val>[N_Emp_main_1]</val>
      </eq>
      <isnull>
        <fld name="EmpTclCat.EmpTclCatEfdDt" />
      </isnull>
      <isnull>
        <fld name="Tcl.TclEfdDt" />
      </isnull>
      <notnull>
        <fld name="EmpTclCat.EmpTclStartDate" />
      </notnull>
      <notnull>
        <fld name="EmpTclCat.EmpTclEndDate" />
      </notnull>
    </and>
  </where>
  <order>
    <fld name="OrderByDate" descending="No" />
  </order>
  <distinct>Yes</distinct>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="ComboAbsCat">
  <tables>
    <tbl name="AbsCat" />
  </tables>
  <display>
    <fld name="AbsCat" />
  </display>
  <order>
    <fld name="AbsCat" />
  </order>
</dataset>
<dataset name="main">
  <tables>
    <tbl name="Emp" />
    <tbl name="EmpAbsCat" main="Yes" join="LEFT" to="Emp">
      <eq>
        <fld name="Emp.Emp" />
        <fld name="EmpAbsCat.Emp" />
      </eq>
    </tbl>
  </tables>
  <display>
    <fld name="EmpAbsCat.*" />
    <fld name="Emp.Emp" />
    <fld name="Emp.ActMilitary" />
    <fld name="EmpNo">
      <append>
        <fld name="Emp.Emp" type="String" />
      </append>
    </fld>
    <fld name="StrHireDt">
      <native lang="SqlServer">cast(Emp.HireDt as varchar)</native>
    </fld>
    <fld name="FMLAElig">
      <native lang="SQLServer">
        case
          when datediff(d,Emp.HireDt,getdate())/CASE WHEN year(getDate())%4 = 0 THEN 366 ELSE 365 END &gt;= 1 then 'Yes'
          else 'No'
        end
      </native>
    </fld>
    <fld name="SrvYrs">
      <native lang="SQLServer">datediff(mm,HireDt,getdate())/12</native>
    </fld>
    <script name="EmpHeaderFlds" />
  </display>
  <order>
    <fld name="EmpAbsCatEffDt" descending="Yes" />
    <fld name="EmpAbsCat.AbsCat" />
  </order>
  <where>[v_sWhereClause]</where>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="IncludeHistoryStatus">
  <tables>
    <tbl name="Cfg" />
  </tables>
  <display>
    <fld name="IncludeHistory">
      <native lang="SQLServer">
        <![CDATA[
          case
            when ConfigValues like '%[F_Application]%' then '[LT]ge[GT][LT]fld name="EmpAbsCatEfdDt" /[GT][LT]val[GT][Date][LT]/val[GT][LT]/ge[GT]'
            else '[LT]eq[GT][LT]val[GT]1[LT]/val[GT][LT]val[GT]1[LT]/val[GT][LT]/eq[GT]'
          end
        ]]>
      </native>
    </fld>
  </display>
  <where>
    <eq>
      <fld name="Cfg" />
      <val>EmpAbsCat.Dsp</val>
    </eq>
  </where>
</dataset>
<dataset name="Fmla">
  <tables>
    <tbl name="Emp" />
    <tbl name="EmpTim" join="LEFT" to="Emp">
      <and>
        <eq>
          <fld name="Emp.Emp" />
          <fld name="EmpTim.Emp" />
        </eq>
        <in>
          <fld name="TimAct" />
          <dataset name="SelTimAct">
            <tables>
              <tbl name="TimAct" />
            </tables>
            <display>
              <fld name="TimAct" />
            </display>
            <where>
              <in>
                <fld name="AbsCat" />
                <dataset name="SelAbsCat">
                  <tables>
                    <tbl name="AbsCat" />
                  </tables>
                  <display>
                    <fld name="AbsCat" />
                  </display>
                  <where>
                    <and>
                      <eq>
                        <fld name="FMLA" />
                        <val>1</val>
                      </eq>
                      <ne>
                        <fld name="AbsCat" />
                        <val>MilitaryFMLA</val>
                      </ne>
                    </and>
                  </where>
                </dataset>
              </in>
            </where>
          </dataset>
        </in>
        <ge>
          <fld name="EmpTimEffDt" />
          <fld name="mydatetime">
            <native lang="SQLServer">getdate()-365</native>
          </fld>
        </ge>
        <le>
          <fld name="EmpTimEffDt" />
          <val>[Date]</val>
        </le>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="Emp.Emp" />
    <fld name="FMLAAbsCat">
      <native lang="SQLServer">'FMLA'</native>
    </fld>
    <fld name="EmpAbsCatEffDt" type="DateTime">
      <native lang="SQLServer">
        SELECT getDate() - CASE WHEN year(getDate())%4 = 0 THEN 366 ELSE 365 END
      </native>
    </fld>
    <fld name="EmpAbsCatEfdDt" type="DateTime">
      <native lang="SQLServer">getdate()</native>
    </fld>
    <fld name="DaysAccrued" type="Number">
      <native lang="SQLServer">60</native>
    </fld>
    <fld name="HoursAccrued" type="Number">
      <native lang="SQLServer">
        60 * (Select (Case When Sum(Eml.WrkHrs) = 0 Then 40 Else IsNull(sum(Eml.WrkHrs),40) End/5) from Eml where EmlEfdDt is null and Eml.Emp = Emp.Emp)
      </native>
    </fld>
    <fld name="DaysTaken" type="Number">
      <native lang="SQLServer">IsNull(Sum(Hours/8), 0)</native>
    </fld>
    <fld name="HoursTaken" type="Number">
      <native lang="SQLServer">IsNull(Sum(Hours), 0)</native>
    </fld>
    <fld name="DaysRemaining" type="Number">
      <native lang="SQLServer">(60-IsNull(Sum(Hours/8), 0))</native>
    </fld>
    <fld name="HoursRemaining" type="Number">
      <native lang="SQLServer">
        (60 * (Select (Case When Sum(WrkHrs) = 0 Then 40 Else IsNull(sum(WrkHrs),40) End/5) from Eml where Eml.EmlEfdDt is null and Eml.Emp = Emp.Emp))-IsNull(Sum(Hours), 0)
      </native>
    </fld>
  </display>
  <where>
    <eq>
      <fld name="Emp.Emp" />
      <val>[var_Emp]</val>
    </eq>
  </where>
  <group>
    <fld name="Emp.Emp" />
  </group>
  <includehistory>Yes</includehistory>
</dataset>
<dataset name="ActiveMilitaryFmla">
  <tables>
    <tbl name="Emp" />
    <tbl name="EmpTim" join="LFFT" to="Emp">
      <and>
        <eq>
          <fld name="Emp.Emp" />
          <fld name="EmpTim.Emp" />
        </eq>
        <in>
          <fld name="TimAct" />
          <dataset name="SelTimAct">
            <tables>
              <tbl name="TimAct" />
            </tables>
            <display>
              <fld name="TimAct" />
            </display>
            <where>
              <in>
                <fld name="AbsCat" />
                <dataset name="SelAbsCat">
                  <tables>
                    <tbl name="AbsCat" />
                  </tables>
                  <display>
                    <fld name="AbsCat" />
                  </display>
                  <where>
                    <and>
                      <eq>
                        <fld name="FMLA" />
                        <val>1</val>
                      </eq>
                      <eq>
                        <fld name="AbsCat" />
                        <val>MilitaryFMLA</val>
                      </eq>
                    </and>
                  </where>
                </dataset>
              </in>
            </where>
          </dataset>
        </in>
        <ge>
          <fld name="EmpTimEffDt" />
          <fld name="mydatetime">
            <native lang="SQLServer">getdate()-(SELECT CASE WHEN year(getDate())%4 = 0 THEN 366 ELSE 365 END)</native>
          </fld>
        </ge>
        <le>
          <fld name="EmpTimEffDt" />
          <val>[Date]</val>
        </le>
      </and>
    </tbl>
  </tables>
  <display>
    <fld name="Emp.Emp" />
    <fld name="FMLAAbsCat">
      <native lang="SQLServer">'Active Military FMLA'</native>
    </fld>
    <fld name="EmpAbsCatEffDt" type="DateTime">
      <native lang="SQLServer">
        (getDate() - (SELECT CASE WHEN year(getDate())%4 = 0 THEN 366 ELSE 365 END))
      </native>
    </fld>
    <fld name="EmpAbsCatEfdDt" type="DateTime">
      <native lang="SQLServer">getdate()</native>
    </fld>
    <fld name="DaysAccrued" type="Number">
      <native lang="SQLServer">70</native>
    </fld>
    <fld name="HoursAccrued" type="Number">
      <native lang="SQLServer">
        70 * (Select (Case When Sum(Eml.WrkHrs) = 0 Then 40 Else IsNull(sum(Eml.WrkHrs),40) End/5) from Eml where EmlEfdDt is null and Eml.Emp = Emp.Emp)
      </native>
    </fld>
    <fld name="DaysTaken" type="Number">
      <native lang="SQLServer">IsNull(Sum(Hours/8), 0)</native>
    </fld>
    <fld name="HoursTaken" type="Number">
      <native lang="SQLServer">IsNull(Sum(Hours), 0)</native>
    </fld>
    <fld name="DaysRemaining" type="Number">
      <native lang="SQLServer">(70-IsNull(Sum(Hours/8), 0))</native>
    </fld>
    <fld name="HoursRemaining" type="Number">
      <native lang="SQLServer">
        (70 * (Select (Case When Sum(WrkHrs) = 0 Then 40 Else IsNull(sum(WrkHrs),40) End/5) from Eml where Eml.EmlEfdDt is null and Eml.Emp = Emp.Emp))-IsNull(Sum(Hours), 0)
      </native>
    </fld>
  </display>
  <where>
    <and>
      <eq>
        <fld name="Emp.Emp" />
        <val>[var_Emp]</val>
      </eq>
      <eq>
        <fld name="Emp.ActMilitary" />
        <val>1</val>
      </eq>
    </and>
  </where>
  <group>
    <fld name="Emp.Emp" />
  </group>
  <includehistory>Yes</includehistory>
</dataset>
<view name="list">
  <script name="EmpHeaderCtlsCZ" />
  <display>
    <title>Employee Absences</title>
    <instructions>Enter Employee Absences Information</instructions>
    <head />
    <if>
      <when>
        <eq>
          <val>[var_Readonly]</val>
          <val>No</val>
        </eq>
      </when>
      <then>
        <toolbar>
          <add />
        </toolbar>
      </then>
      <else>
        <toolbar />
      </else>
    </if>
    <set var="[var_Emp]">[fld_main.Emp]</set>
    <set var="[var_HireDt]">[fld_main.StrHireDt]</set>
    <set var="[var_FMLAElig]">[fld_main.FMLAElig]</set>
    <set var="[var_ActiveMilitary]">[fld_main.ActMilitary]</set>
    <body>
      <datasheet dataset="main" showlinecount="No" headers="OVER" next="No">
        <script name="EmpHeaderGrpCZ" />
      </datasheet>
      <row>
        <col>
          <tabset>
            <tab name="Absence Tracking" selected="Yes">
              <datasheet dataset="main" headers="TOP" showlinecount="Yes" width="1400">
                <groups>
                  <groupby val="[fld_EmpAbsCatEffDt]">
                    <header>
                      <row>
                        <col>[ctl_EmpAbsCatEffDt]</col>
                      </row>
                    </header>
                  </groupby>
                </groups>
                <row>
                  <col>[ctl_AbsCat]</col>
                  <col>[ctl_EmpAbsCatEffDt]</col>
                  <col>[ctl_EmpAbsCatEfdDt]</col>
                  <col>[ctl_Lbl2]</col>
                  <col>[ctl_Lbl3]</col>
                  <col>[ctl_Lbl4]</col>
                  <col>[ctl_Lbl5]</col>
                  <col>[ctl_Lbl6]</col>
                  <col>[ctl_Lbl7]</col>
                  <col>[ctl_Lbl8]</col>
                  <col>[ctl_Lbl9]</col>
                  <col>[ctl_CarryOverExpDate]</col>
                  <col>[ctl_CarryOverTimeUsed]</col>
                  <col>[ctl_CarryOverTimeExp]</col>
                  <col>[ctl_PrjDaysAccrued] </col>
                  <col>[ctl_PrjHoursAccrued] </col>
                  <col>[ctl_PrjDaysRemaining] </col>
                  <col>[ctl_PrjHoursRemaining] </col>
                  <col>[ctl_PrjDaysTaken] </col>
                  <col>[ctl_PrjHoursTaken] </col>
                </row>
              </datasheet>
            </tab>
            <tab name="FMLA Tracking">
              <if>
                <when>
                  <eq>
                    <val>[var_FMLAElig]</val>
                    <val>No</val>
                  </eq>
                </when>
                <then>
                  <v>Employee has not been employed for 1 year (Hire Date = [var_HireDt]) and is not eligible for FMLA</v>
                </then>
                <else>
                  <datasheet dataset="Fmla" headers="TOP" showlinecount="No">
                    <row>
                      <col>[ctl_FMLAAbsCat]</col>
                      <col>[ctl_FMLAEffDt]</col>
                      <col>[ctl_FMLAEfdDt]</col>
                      <col>[ctl_FMLADaysAccrued]</col>
                      <col>[ctl_FMLAHoursAccrued]</col>
                      <col>[ctl_FMLADaysTaken]</col>
                      <col>[ctl_FMLAHoursTaken]</col>
                      <col>[ctl_FMLADaysRemaining]</col>
                      <col>[ctl_FMLAHoursRemaining]</col>
                    </row>
                    <if>
                      <when>
                        <eq>
                          <val>[var_ActiveMilitary]</val>
                          <val>Yes</val>
                        </eq>
                      </when>
                      <then>
                        <foreach dataset="ActiveMilitaryFmla">
                          <row>
                            <col>[ctl_FMLAAbsCat1]</col>
                            <col>[ctl_FMLAEffDt]</col>
                            <col>[ctl_FMLAEfdDt]</col>
                            <col>[ctl_FMLADaysAccrued1]</col>
                            <col>[ctl_FMLAHoursAccrued1]</col>
                            <col>[ctl_FMLADaysTaken1]</col>
                            <col>[ctl_FMLAHoursTaken1]</col>
                            <col>[ctl_FMLADaysRemaining1]</col>
                            <col>[ctl_FMLAHoursRemaining1]</col>
                          </row>
                        </foreach>
                      </then>
                    </if>
                  </datasheet>
                </else>
              </if>
            </tab>
          </tabset>
        </col>
      </row>
    </body>
  </display>
</view>
<view name="edit">
  <script name="EmpHeaderCtlsCZ" />
  <display>
    <title>Employee Absences</title>
    <instructions>Enter Employee Absences Information</instructions>
    <head />
    <if>
      <when>
        <eq>
          <val>[var_Readonly]</val>
          <val>No</val>
        </eq>
      </when>
      <then>
        <toolbar>
          <find />
          <add />
          <save />
          <delete />
        </toolbar>
      </then>
      <else>
        <toolbar />
      </else>
    </if>
    <set var="[var_Emp]">[fld_main.Emp]</set>
    <set var="[var_HireDt]">[fld_main.HireDt]</set>
    <set var="[var_FMLAElig]">[fld_main.FMLAElig]</set>
    <body>
      <datasheet dataset="main" headers="LEFT">
        <groups>
          <groupby val="[fld_EmpId]">
            <header>
              <row>
                <col wrap="No">[ctl_FullName][ctl_Emp]</col>
                <if>
                  <when>
                    <eq>
                      <val>[var_Readonly]</val>
                      <val>No</val>
                    </eq>
                  </when>
                  <then>
                    <col>[ctl_PrcAbsCat]</col>
                  </then>
                </if>
              </row>
            </header>
          </groupby>
        </groups>
<!--
        <row>
          <col span="2">[ctl_AbsCat]</col><col>[ctl_asOfDate]</col>
        </row>
        <row>
          <col span="2">[ctl_EmpAbsCatEffDt]</col><col>[ctl_PrcAsOfValue]</col>
        </row>
        <row>
          <col span="2">[ctl_EmpAbsCatEfdDt]</col><col>[ctl_PrcAsOf]</col>
        </row>
-->
        <row>
          <col span="2">[ctl_AbsCat]</col>
        </row>
        <row>
          <col span="2">[ctl_EmpAbsCatEffDt]</col>
        </row>
        <row>
          <col span="2">[ctl_EmpAbsCatEfdDt]</col>
        </row>
        <row>
          <col>
            <v>Actual Days</v>
          </col>
          <col>
            <v>Projected Days</v>
          </col>
        </row>
        <row>
          <col align="RIGHT">[ctl_DaysCarriedOver]</col>
          <col align="RIGHT">[ctl_DaysCarriedOver]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_DaysAccrued]</col>
          <col align="RIGHT">[ctl_PrjDaysAccrued]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_DaysTaken]</col>
          <col align="RIGHT">[ctl_PrjDaysTaken]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_DaysRemaining]</col>
          <col align="RIGHT">[ctl_PrjDaysRemaining]</col>
        </row>
        <row>
          <col>
            <v>Actual Hours</v>
          </col>
          <col>
            <v>Projected Hours</v>
          </col>
        </row>
        <row>
          <col align="RIGHT">[ctl_HoursCarriedOver]</col>
          <col align="RIGHT">[ctl_HoursCarriedOver]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_HoursAccrued]</col>
          <col align="RIGHT">[ctl_PrjHoursAccrued]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_HoursTaken]</col>
          <col align="RIGHT">[ctl_PrjHoursTaken]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_HoursRemaining]</col>
          <col align="RIGHT">[ctl_PrjHoursRemaining]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_CarryOverExpDate]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_CarryOverTimeUsed]</col>
        </row>
        <row>
          <col align="RIGHT">[ctl_CarryOverTimeExp]</col>
        </row>
      </datasheet>
    </body>
  </display>
</view>