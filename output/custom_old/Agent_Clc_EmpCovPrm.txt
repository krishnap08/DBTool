-- 10/01/2010 - AB - Issue 97531 Customized the procedure to add the clients  customized fields.
CREATE PROCEDURE Clc_EmpCovPrm
@Emp varchar(15) = NULL,
@Eml varchar(15) = NULL
AS
SET NOCOUNT ON
       
IF (NOT @Emp IS NULL AND NOT @Eml IS NULL)
BEGIN
         Update ZZEmpBen Set Units = Units, EmpBenEffDt = EmpBenEffDt, EmpPrem = EmpPrem
         From ZZEmpBen t,  ZZBen  b,  ZZEml E
         Where t.Emp = @Emp AND t.Eml = @Eml AND t.Ben = b.Ben AND t.Emp = E.Emp And t.Eml = E.Eml 
         And ((b.ECovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ') 
               or b.CCovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ')) 
         OR t.AnnElectAmt IS NOT NULL 
         OR t.EmpPayPdDed IS NOT NULL) 
         And Not ((Not BenEndDt Is Null And BenEndDt < getDate()) Or ( Not EmpBenEfdDt Is Null And EmpBenEfdDt < GetDate()))
         And E.Emlefddt is null 

         Update ZZEmpBenElg Set Units = Units, EmpPrem = EmpPrem
         From ZZEmpBenElg t, ZZBen b, ZZEml E
         Where t.Emp = @Emp AND t.Eml = @Eml AND t.Ben = b.Ben AND t.Emp = E.Emp And t.Eml = E.Eml 
         And ((b.ECovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ') 
               or b.CCovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ')) 
         OR t.AnnElectAmt IS NOT NULL 
         OR t.EmpPayPdDed IS NOT NULL) 
         And Not ((Not BenEndDt Is Null And BenEndDt < getDate()) Or ( Not EmpBenElgEfdDt Is Null And EmpBenElgEfdDt < GetDate()))
         And E.Emlefddt is null
END 
ELSE 
BEGIN 
         Update ZZEmpBen Set Units = Units, EmpBenEffDt = EmpBenEffDt, EmpPrem = EmpPrem
         From ZZEmpBen t,  ZZBen  b,  ZZEml E
         Where t.Ben = b.Ben AND t.Emp = E.Emp And t.Eml = E.Eml 
         And ((b.ECovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ') 
               or b.CCovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ')) 
         OR t.AnnElectAmt IS NOT NULL 
         OR t.EmpPayPdDed IS NOT NULL) 
         And Not ((Not BenEndDt Is Null And BenEndDt < getDate()) Or ( Not EmpBenEfdDt Is Null And EmpBenEfdDt < GetDate()))
         And E.Emlefddt is null And E.EmpSts NOT IN ('Terminated')

         Update ZZEmpBenElg Set Units = Units, EmpPrem = EmpPrem
         From ZZEmpBenElg t, ZZBen b, ZZEml E
         Where t.Ben = b.Ben AND t.Emp = E.Emp And t.Eml = E.Eml 
         And ((b.ECovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ') 
               or b.CCovMultipleFld In ('AnnualSalary','MonthlySalary','BiWeeklySalary','WeeklySalary','DailySalary','HourlySalary','BLifSalCZ','ADDSalCZ','SL1xSalary','SL2xSalary','ADDHrSalCZ','BLifHrSalCZ','SLHr1xCZ','SLHr2xCZ','LTDSalCZ')) 
         OR t.AnnElectAmt IS NOT NULL 
         OR t.EmpPayPdDed IS NOT NULL) 
         And Not ((Not BenEndDt Is Null And BenEndDt < getDate()) Or ( Not EmpBenElgEfdDt Is Null And EmpBenElgEfdDt < GetDate()))
         And E.Emlefddt is null And E.EmpSts NOT IN ('Terminated')
END 
SET NOCOUNT OFF